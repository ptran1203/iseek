const template_map={1:'\n  <div class="search-result" pk="#id#" onclick="viewDetail(this)">\n<div class="icon">\n  \n</div>\n<div class="content">\n  <h4 class="job-title">#title_m#</h4>\n  <a href="#post_url#" target="_blank">Goto page</a>\n  <p>\n    <span class="salary">#salary_range#</span>\n  </p>\n  <div>\n    <p>#content_m#</p>\n  </div>\n  <div class="actions">\n    <span class="date">#post_date#</span>\n  </div>\n</div>\n</div>\n  ',2:'\n<li class="keyword">\n  <a href="?q=#word#">\n    #word#\n  </a>\n</li>\n',3:'\n<div class="modal-dialog">\n  <div class="modal-header">\n  <h4 class="job-detail-title"><a href="#post_url#" target="_blank">#title#</a></h4>\n  <button class="close-btn"onclick="closeDetail(this)">â›Œ</button>\n  </div>\n  <div class="modal-body">\n      <img src="#post_img#" width="200" style="display:block;margin: 10px auto;"/>\n      <div class="job-infos">\n        <div class="job-info far fa-money-bill-alt">\n          <span style="color:#a95508">#salary_range#</span>\n        </div>\n        <div class="job-info far fa-clock\t">\n          <span style="color:#a95508">#post_date#</span>\n        </div>\n        <div class="job-info fas fa-map-marker-alt">\n          <span style="color:#a95508">#address#</span>\n        </div>\n      </div>\n\n      <div class="job-desc" style="white-space: pre-line">#content#</div>\n  </div>\n  <div class="modal-footer">\n      <a href="#post_url#" class="btn">Appy</a>\n  </div>\n</div>\n'},hostUrl="http://localhost:8000/";let qs=function(e){if(""==e)return{};let n={};for(let t=0;t<e.length;++t){let s=e[t].split("=",2);1==s.length?n[s[0]]="":n[s[0]]=decodeURIComponent(s[1].replace(/\+/g," "))}return n}(window.location.search.substr(1).split("&"));function getUrl(e){return hostUrl+e}let keywords=[],jobs=[];function generate_html(e,n){let t=template_map[n]||"";return Object.keys(e).map(n=>{let s="#"+n+"#";t=t.split(s).join(e[n])}),t}function closeDetail(){document.getElementById("view-detail").style.display="none"}function activeElement(e){let n=e.className.split(" "),t=document.getElementsByClassName("active");(t=t[0])&&t.classList.remove("active"),n.includes("active")||(e.className+=" active")}function viewDetail(e){let n=document.getElementById("view-detail");n.classList.remove("detail"),n.style.display="block";const t=e.getAttribute("pk");let s=jobs.find(e=>e.id==t);n.className+=" detail",n.innerHTML=generate_html(s,3),n.style.overflowY="scroll",n.className.split(" ").includes("opened")||(n.className+=" opened"),activeElement(e)}jQuery(document).ready(function(){let e=$("#loading"),n=$("#jobs"),t=qs.q,s=$("#footer");t&&($("form").attr("class","search-form"),$.ajax({url:getUrl("api/search?q="+t),method:"GET",beforeSend:function(){n.html(""),e.addClass("spinner")},success:function(l){e.removeClass("spinner");let a=l.reduce((e,n)=>e+=generate_html(n,1),""),o=`<span style="color:#982e2e">${t}</span>`;(jobs=l).length?(n.append(`<h3 style="font-family:monospace;text-align:center;padding:4px;color:#2c5656;">\n              ${jobs.length} ${o} jobs for you\n            </h3>`),n.append(a)):n.append(`<div class="empty-jobs">\n           <p> Sorry, we can't find any ${o} jobs for you </p>\n          </div>`),s.css("margin-top","50px")},error:function(e){console.log(e)}})),$.ajax({url:getUrl("api/keywords?sort_type=1&limit=10"),method:"GET",success:function(e){keywords=e;let n=e.slice(0,10).reduce((e,n)=>e+=generate_html(n,2),"");$(".left-side ol").html(n)},error:function(e){console.log(e)}}),$.ajax({url:getUrl("api/count"),method:"GET",success:function(e){keywords=e,$("input:text").attr("placeholder",`search ${e.count||0} jobs`)},error:function(e){console.log(e)}}),$(".search-form").on("submit",function(){let e=$(".searchTerm").val();return window.location.replace(`?q=${e}`),!1})});